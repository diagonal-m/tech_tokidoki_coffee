---
title: 個人的AWS入門(用語集)
date: '2025-2-24'
tags: ['infrastructure']
draft: false
summary: '個人的ネットワーク&サーバー入門記事'
---

## この記事について

自己学習や業務で遭遇したAWSサービスに関連する用語を淡々とまとめていく記事です。  
逐次更新していきます。

## 目次

<TOCInline toc={props.toc} exclude="目次" toHeading={2} />

## VPC(Amazon Virtual Private Cloud)

> [!NOTE]
> Amazon Virtual Private Cloud (VPC) は、AWS上に構築する仮想ネットワークです。
> AWSリソース（EC2やRDSなど）をセキュアに管理するために、独立したネットワーク環境を作成できます。

![introduction_to_aws_1](/static/images/infrastructure/aws/introduction_to_aws_1.png)

### VPCの基本構成
VPCでは、ネットワークやサブネットの範囲、ルートテーブルやネットワークゲートウェイの設定など、仮想ネットワーキング環境を設定できます。
![introduction_to_aws_3](/static/images/infrastructure/aws/introduction_to_aws_3.png)

#### ① CIDR(IPアドレス範囲)
VPCを作成するときに、IPアドレス範囲（CIDR） を指定する。  
例えば 10.0.0.0/16 を指定すると、10.0.0.0 ~ 10.0.255.255 の範囲内でIPを割り振れるようになる。

#### ② サブネット
VPC内のIPアドレス範囲をさらに分割して、複数のサブネットを作成できる。  
サブネットにはパブリックサブネットとプライベートサブネットの2種類がある。  
- パブリックサブネットには、ルートテーブルでIGW（インターネットゲートウェイ）へのルートを設定。
- プライベートサブネットはIGWを介さず、必要に応じてNATゲートウェイを使用。

#### ③ ルートテーブル
ルートテーブルは、サブネットごとの通信ルールを決定する。  
VPC内のトラフィックがどの経路を通るのかを制御するための設定。
- 各サブネットに関連付けて使用する。
- 送信先とターゲット（行き先）を設定する。

| 送信先 | ターゲット |
| ----- | -------- |
| 10.0.0.0/21 | local |
| 0.0.0.0/0 | igw-xxxxxxxx（インターネットゲートウェイ） |
| 172.16.0.0/16 | nat-xxxxxxxx（NATゲートウェイ） |

#### ④ インターネットゲートウェイ(IGW)

VPC内のリソースを インターネットに接続するためのゲートウェイ。
- VPC内のAWSリソースとインターネットを繋ぐ役割を持つ。
- 自動スケール し、高可用性がある。
- パブリックサブネットのルートテーブル にIGWを設定することで機能する。

#### ⑤ NATゲートウェイ
プライベートサブネット内のリソースが、外部へ通信できるようにするゲートウェイ。

- 外部APIなどへアクセスしたいが、外部からの直接のアクセスは防ぎたい場合に利用。
- アウトバウンド通信（送信）は可能、インバウンド通信（受信）は不可。
- NATゲートウェイはプライベートサブネットのルートテーブルに設定する。

#### ⑥ セキュリティグループ（SG） & ネットワークACL
VPCには、セキュリティを管理する仕組みが2つある。

| 名前           | 役割 |
| ------------- | ---- |
| セキュリティグループ（SG） | EC2やRDSなどの リソース単位 で適用 |
| ネットワークACL（NACL） | サブネット全体に適用（細かい制御が可能） |

違いとしては、セキュリティグループは「リソース単位」、NACLは「サブネット単位」 で制御すること。

#### ⑦ Elastic Network Interface
AWSの 仮想ネットワークインターフェース であり、EC2インスタンスなどのリソースにアタッチされる。

- EC2のIPアドレスはENIに紐づく
- 複数のENIを1つのEC2インスタンスにアタッチ可能
- ENIを切り替えて異なるインスタンスにアタッチすることも可能

#### ⑧ Elastic IP(EIP)
AWS上で 固定のパブリックIPアドレス を割り当てるための機能。

| 種類 | 説明 |
| --- | ---- |
| Public IP Address | AWSのIPプールからランダムに割り当て（EC2再起動時に変更される） |
| Elastic IP Address（EIP） |  固定のパブリックIPアドレス（インスタンスの停止・再起動後も維持） |

- EC2インスタンスのデフォルトのPublic IPは可変（再起動すると変わる）。
- EIPを使用すれば静的なパブリックIPを確保できる。
- EIPは使っていないと課金されるため、未使用のEIPは解放することを推奨。

## サブネット・パブリックサブネット・プライベートサブネット

![introduction_to_aws_2](/static/images/infrastructure/aws/introduction_to_aws_2.png)

### サブネット
VPCで確保した大きなネットワークを、小さなネットワークに分割すること。

### パブリックサブネット・プライベートサブネット

| サブネットの種類 | 説明 |
| ------------- | ---- |
| パブリックサブネット | インターネットに接続できる（NATゲートウェイやIGWを通す） |
| プライベートサブネット | インターネットに直接接続しない（内部のサーバー用） |


## セキュリティグループ
AWSには、VPCのネットワークセキュリティを管理する仕組みとしてセキュリティグループ（SG）とネットワークACL（NACL）が用意されています。  
これらは 仮想ファイアウォールとして機能し、インバウンド（外部からの通信）とアウトバウンド（内部から外部への通信）のトラフィックを制御します。

### セキュリティグループとネットワークACLの特徴

どちらも トラフィックを制御する役割 を持つが、適用範囲や動作が異なります。

| **項目** | **セキュリティグループ（SG）** | **ネットワークACL（NACL）** |
| --- | ------------------------------ | --------------------------- |
| **適用範囲** | **インスタンス単位**（最大5つ適用可能） | **サブネット単位**（VPC内のサブネットに適用） |
| **ルールの種類** | **許可（ALLOW）のみ設定可能** | **許可（ALLOW）と拒否（DENY）の両方設定可能** |
| **ステートフル / ステートレス** | **ステートフル**（戻りの通信は自動許可） | **ステートレス**（戻りの通信も明示的に許可が必要） |
| **ルールの評価方法** | **すべてのルールを評価し、最も緩いルールが適用** | **上から順に評価し、一致したルールが適用** |

- セキュリティグループ は EC2などのリソース単位 で適用され、ステートフル（戻り通信は自動許可）。
- ネットワークACL は サブネット単位 で適用され、ステートレス（戻り通信も明示的に許可が必要）。
- デフォルトの設定
  - セキュリティグループ は インバウンドはすべて拒否、アウトバウンドはすべて許可。
  - ネットワークACL は デフォルトでインバウンド・アウトバウンドともに許可（カスタム作成時はすべて拒否）。

#### インバウンドとアウトバウンドの設定とウェルノウンポート
ポート（Port）は 通信の入り口 を表し、サービスごとに特定のポート番号が割り当てられています。  
例えば、Webサーバー（HTTP）は80番、SSHは22番 など、標準のポート番号（Well-Known Ports）が決まっています。  

**AWSのトラフィック制御**
- インバウンド（Inbound）：外部からインスタンスやリソースへの通信を制御
- アウトバウンド（Outbound）：インスタンスやリソースから外部への通信を制御

設定例）
1. SSHでのリモート接続を許可
```
- ポート番号: 22
- プロトコル: TCP
- インバウンド許可: 自分のIPアドレス（例: 203.0.113.24/32）
```
2. Webサーバー(HTTP/HTTPS)を公開
```
- ポート番号: 80（HTTP）, 443（HTTPS）
- プロトコル: TCP
- インバウンド許可: すべてのIPアドレス（0.0.0.0/0, ::/0）
```
